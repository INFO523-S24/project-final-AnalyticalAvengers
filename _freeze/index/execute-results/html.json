{
  "hash": "42190d42f4c9184d5df6225a81cef0e0",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: ANALYTICAL AVENGERS\nsubtitle: INFO 523 - Project Final\nauthor:\n  - name: 'ANALYTICAL AVENGERS-<br> MELIKA AKBARSHARIFI, Divya liladhar Dhole, Mohammad Ali Farmani,<br> H M Abdul Fattah, Gabriel Gedaliah Geffen, Tanya George, Sunday Usman '\n    affiliations:\n      - name: 'School of Information, University of Arizona'\ndescription: Project description\nformat:\n  html:\n    code-tools: true\n    code-overflow: wrap\n    embed-resources: true\neditor: visual\nexecute:\n  warning: false\n  echo: false\n---\n\n## Abstract\n\nThis study investigates the relationship between age demographics and severe crashes, with a focus on developing a predictive model to enhance road safety in Massachusetts. Using a crash dataset from January 2024, we explore how age correlates with the severity of crashes and examine environmental factors like lighting, weather, road conditions, speed limits, and the number of vehicles involved. Our analysis reveals crucial patterns, indicating which age groups, both drivers and vulnerable users, are at greater risk of severe crashes. Additionally, we identify environmental conditions that contribute to the likelihood and severity of crashes, providing insights for targeted safety measures. To classify crash severity, we experimented with various machine learning (ML) techniques, including logistic regression, decision trees, random forests, and K Nearest Neighbors (KNN). Our models achieved a 100% prediction accuracy, indicating a strong ability to classify crash severity based on the selected features. However, the absence of road volume or vehicle miles traveled data poses a limitation in contextualizing the frequency of crashes. The outcomes of our research offer valuable tools for policymakers and practitioners, allowing for more proactive safety measures and resource allocation. By accurately predicting crash risks based on age demographics and environmental conditions, authorities can implement preemptive interventions to reduce severe accidents. Ultimately, this study contributes to a data-driven approach to road safety, with the potential to make tangible improvements in public safety and traffic management.\n\n## Introduction\n\nUnderstanding the factors contributing to severe car crashes is crucial for improving road safety and reducing traffic-related injuries and fatalities. This project aims to develop a predictive model that correlates age demographics with severe crashes in Massachusetts. The ultimate goal is to identify key risk factors and provide data-driven insights for implementing effective safety measures.\n\nOur team is analyzing a comprehensive dataset of car crashes from January 2024, collected from the Massachusetts Registry of Motor Vehicles. This dataset comprises 72 dimensions, encompassing a range of variables, including crash characteristics, driver demographics, environmental conditions, and vehicle information. By examining these variables, we seek to uncover patterns that link age with severe crashes, offering valuable insights into potential high-risk groups and circumstances.\n\nOur analysis focuses on two main research questions: identifying the age groups most at risk for severe crashes and exploring the role of environmental factors such as lighting, weather, road conditions, and speed limits. Additionally, we aim to develop a predictive model capable of classifying crash severity based on these variables. To achieve this, we used multiple binary classification models, which are known for their simplicity and effectiveness in classification tasks.\n\nThe methodology for our analysis involved several key steps. First, we pre-processed the dataset to handle missing data, standardize categorical variables, and scale numerical features. Next, we conducted exploratory data analysis to identify significant correlations and patterns. To predict crash severity, we trained a KNN model using a subset of the data and evaluated its performance on a separate test set. The model's accuracy, precision, recall, and F1-score were measured to determine its effectiveness. The high accuracy achieved in the model's predictions indicates its potential for real-world application in road safety.\n\nThis report details our approach to analyzing the Massachusetts crash dataset, including the steps taken to process the data, build the predictive model, and evaluate its performance. We discuss our findings and provide insights into which age groups are most at risk, along with the environmental factors that contribute to severe crashes. Through this work, we aim to contribute to road safety practices and provide useful information for policymakers, traffic safety professionals, and other stakeholders interested in reducing traffic-related incidents and enhancing public safety.\n\n## Questions\n\n1. Which age groups are at the highest risk of getting into severe crashes, and how do factors like lighting, weather, road conditions, speed limits, and the number of vehicles involved contribute to the likelihood of certain age groups being in more danger?\n2. Is it possible to develop a model that can accurately classify the severity of crashes based on our findings from the previous question about factors that contribute to said level of danger?\n\n## Analysis Plan\n\n\n\n\n\n::: {#d2f891bb .cell execution_count=3}\n\n::: {.cell-output .cell-output-stdout}\n```\nDistinct data types of features in crash_data:\n[dtype('O') dtype('float64')]\nFirst few rows of the crash data: \n   Crash Number City Town Name  Crash Date  \\\n0      5342297         LOWELL  01/01/2024   \n1      5342292         LOWELL  01/01/2024   \n2      5342292         LOWELL  01/01/2024   \n3      5342292         LOWELL  01/01/2024   \n4      5342292         LOWELL  01/01/2024   \n\n                        Crash Severity Crash Status Crash Time  Crash Year  \\\n0                     Non-fatal injury         Open    3:26 AM      2024.0   \n1  Property damage only (none injured)         Open   12:48 AM      2024.0   \n2  Property damage only (none injured)         Open   12:48 AM      2024.0   \n3  Property damage only (none injured)         Open   12:48 AM      2024.0   \n4  Property damage only (none injured)         Open   12:48 AM      2024.0   \n\n  Max Injury Severity Reported  Number of Vehicles Police Agency Type  ...  \\\n0          Possible Injury (C)                 1.0       Local police  ...   \n1       No Apparent Injury (O)                 2.0       Local police  ...   \n2       No Apparent Injury (O)                 2.0       Local police  ...   \n3       No Apparent Injury (O)                 2.0       Local police  ...   \n4       No Apparent Injury (O)                 2.0       Local police  ...   \n\n    X   Y Latitude Longitude Vehicle Unit Number Vehicle Make Vehicle Model  \\\n0 NaN NaN      NaN       NaN                 1.0         HOND          HR-V   \n1 NaN NaN      NaN       NaN                 1.0         NISS        ALTIMA   \n2 NaN NaN      NaN       NaN                 2.0         HOND        ACCORD   \n3 NaN NaN      NaN       NaN                 2.0         HOND        ACCORD   \n4 NaN NaN      NaN       NaN                 2.0         HOND        ACCORD   \n\n  Person Number   Age         Sex  \n0           1.0  32.0  F - Female  \n1           1.0  60.0    M - Male  \n2           2.0   NaN         NaN  \n3           3.0  31.0    M - Male  \n4           4.0   NaN    M - Male  \n\n[5 rows x 72 columns]\n```\n:::\n:::\n\n\n### Question 1\n\n::: {#summary-statistics-for-numerical-variables .cell execution_count=4}\n\n::: {.cell-output .cell-output-stdout}\n```\n       Crash Year  Number of Vehicles  MassDOT District  Total Fatalities  \\\ncount     25547.0        25547.000000      25547.000000      25547.000000   \nmean       2024.0            1.976749          4.019063          0.003562   \nstd           0.0            0.702530          1.325421          0.068730   \nmin        2024.0            1.000000          1.000000          0.000000   \n25%        2024.0            2.000000          3.000000          0.000000   \n50%        2024.0            2.000000          4.000000          0.000000   \n75%        2024.0            2.000000          5.000000          0.000000   \nmax        2024.0            9.000000          6.000000          3.000000   \n\n       Total Non-Fatal Injuries   Speed Limit              X              Y  \\\ncount              25547.000000  23389.000000   21002.000000   21002.000000   \nmean                   0.318824     34.394502  205930.128516  887470.383156   \nstd                    0.728140     12.979679   49539.383540   31782.135543   \nmin                    0.000000      1.000000   44708.708525  779050.104521   \n25%                    0.000000     25.000000  179154.370652  870946.937400   \n50%                    0.000000     30.000000  224092.943601  889548.926635   \n75%                    0.000000     40.000000  237299.607076  908937.437400   \nmax                    8.000000     65.000000  327948.082270  958417.191000   \n\n           Latitude     Longitude  Vehicle Unit Number  Person Number  \\\ncount  20823.000000  20823.000000         25220.000000   25547.000000   \nmean      42.234940    -71.431249             1.489968       1.918699   \nstd        0.287058      0.600959             0.637851       1.568750   \nmin       41.251611    -73.386241             1.000000       1.000000   \n25%       42.086592    -71.756001             1.000000       1.000000   \n50%       42.254041    -71.209095             1.000000       2.000000   \n75%       42.428108    -71.049485             2.000000       2.000000   \nmax       42.874973    -69.962834             9.000000      42.000000   \n\n                Age  \ncount  23002.000000  \nmean      38.952265  \nstd       18.503512  \nmin        0.000000  \n25%       24.000000  \n50%       36.000000  \n75%       53.000000  \nmax       99.000000  \nAge                       2548\nLight Conditions             3\nWeather Conditions           3\nRoad Surface Condition       3\ndtype: int64\n```\n:::\n:::\n\n\n::: {#handling-missing-and-duplicate-rows .cell execution_count=5}\n\n::: {.cell-output .cell-output-stdout}\n```\nAge                       0\nLight Conditions          0\nWeather Conditions        0\nRoad Surface Condition    0\ndtype: int64\n```\n:::\n:::\n\n\n\n\n::: {#cell-Visualization of age group and crash severity .cell execution_count=7}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/visualization-of-age-group-and-crash-severity-output-1.png){#visualization-of-age-group-and-crash-severity width=973 height=523}\n:::\n:::\n\n\n::: {#cell-Visualizations for crash severity and Light Conditions .cell execution_count=8}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/visualizations-for-crash-severity-and-light-conditions-output-1.png){#visualizations-for-crash-severity-and-light-conditions width=1131 height=749}\n:::\n:::\n\n\n::: {#9e75f1c7 .cell execution_count=9}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-10-output-1.png){width=745 height=731}\n:::\n:::\n\n\n::: {#cell-Visualizations for crash severity and weather Conditions .cell execution_count=10}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/visualizations-for-crash-severity-and-weather-conditions-output-1.png){#visualizations-for-crash-severity-and-weather-conditions width=1185 height=922}\n:::\n:::\n\n\n::: {#6d6eb576 .cell execution_count=11}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-12-output-1.png){width=748 height=670}\n:::\n:::\n\n\n::: {#cell-Visualizations for crash severity and road surface Conditions .cell execution_count=12}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/visualizations-for-crash-severity-and-road-surface-conditions-output-1.png){#visualizations-for-crash-severity-and-road-surface-conditions width=626 height=523}\n:::\n:::\n\n\n::: {#ae24730f .cell execution_count=13}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-14-output-1.png){width=767 height=688}\n:::\n:::\n\n\n::: {#cell-Visualizations for number of crashes by Age Group and Light Conditions .cell execution_count=14}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/visualizations-for-number-of-crashes-by-age-group-and-light-conditions-output-1.png){#visualizations-for-number-of-crashes-by-age-group-and-light-conditions width=750 height=523}\n:::\n:::\n\n\n\n\n### Question 2:\n\n\n\n::: {#4a7beec6 .cell execution_count=17}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-18-output-1.png){width=1182 height=241}\n:::\n:::\n\n\n::: {#c66ad7a2 .cell execution_count=18}\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Missing Values for numerical features: \n\n                           Missing Values  Percentage (%)\nCrash Year                             3        0.012189\nNumber of Vehicles                     3        0.012189\nMassDOT District                       3        0.012189\nTotal Fatalities                       3        0.012189\nTotal Non-Fatal Injuries               3        0.012189\nSpeed Limit                         1984        8.060781\nX                                   4442       18.047373\nY                                   4442       18.047373\nLatitude                            4612       18.738065\nLongitude                           4612       18.738065\nVehicle Unit Number                  326        1.324503\nPerson Number                          3        0.012189\nAge                                    0        0.000000\nfeature_variable                       0        0.000000 \n\n\nAnalysis of Missing Values for categorical features: \n\n                                                     Missing Values  \\\nCrash Number                                                     0   \nCity Town Name                                                   0   \nCrash Date                                                       3   \nCrash Status                                                     3   \nCrash Time                                                       3   \nMax Injury Severity Reported                                     3   \nPolice Agency Type                                               3   \nState Police Troop                                           19852   \nAge of Driver - Youngest Known                                 489   \nAge of Driver - Oldest Known                                   487   \nAge of Vulnerable User - Youngest Known                      23848   \nAge of Vulnerable User - Oldest Known                        23848   \nCrash Hour                                                       3   \nDriver Contributing Circumstances (All Drivers)                668   \nDriver Distracted By (All Vehicles)                           4628   \nFirst Harmful Event                                              3   \nIs Geocoded                                                      3   \nLight Conditions                                                 0   \nManner of Collision                                              3   \nVulnerable User Action (All Persons)                         23921   \nVulnerable User Location (All Persons)                       23921   \nVulnerable User Type (All Persons)                           23864   \nRMV Document Numbers                                            70   \nRoad Surface Condition                                           0   \nRoadway Junction Type                                            3   \nRPA Abbreviation                                                 3   \nTraffic Control Device Type                                      3   \nTrafficway Description                                           3   \nVehicle Actions Prior to Crash (All Vehicles)                    3   \nVehicle Configuration (All Vehicles)                            38   \nVehicle Emergency Use (All Vehicles)                           661   \nVehicle Towed From Scene (All Vehicles)                         78   \nVehicle Travel Directions (All Vehicles)                         3   \nWeather Conditions                                               0   \nCounty Name                                                      3   \nCrash Report IDs                                                 3   \nFMCSA Reportable (All Vehicles)                                  3   \nFMCSA Reportable (Crash)                                         3   \nFirst Harmful Event Location                                     3   \nGeocoding Method                                              4442   \nHit and Run                                                      3   \nLocality                                                     24597   \nMost Harmful Event (All Vehicles)                              301   \nRoad Contributing Circumstance                               16861   \nSchool Bus Related                                               3   \nTraffic Control Device Function                                  3   \nVehicle Sequence of Events (All Vehicles)                      235   \nWork Zone Related                                                3   \nVulnerable User Sequence of Events (All Persons)             24594   \nVulnerable User Distracted By (All Persons)                  24598   \nVulnerable User Traffic Control Type (All persons)           24596   \nVulnerable User Origin Destination (All Persons)             24596   \nVulnerable User Contributing Circumstances (All...           24598   \nVulnerable User Alcohol Suspected Type (All Per...           24599   \nVulnerable User Drug Suspected Type (All Persons)            24599   \nVehicle Make                                                   818   \nVehicle Model                                                 5149   \nSex                                                           1556   \nAge Group                                                        0   \nWeather Group                                                22961   \n\n                                                    Percentage (%)  \nCrash Number                                              0.000000  \nCity Town Name                                            0.000000  \nCrash Date                                                0.012189  \nCrash Status                                              0.012189  \nCrash Time                                                0.012189  \nMax Injury Severity Reported                              0.012189  \nPolice Agency Type                                        0.012189  \nState Police Troop                                       80.656564  \nAge of Driver - Youngest Known                            1.986755  \nAge of Driver - Oldest Known                              1.978629  \nAge of Vulnerable User - Youngest Known                  96.891886  \nAge of Vulnerable User - Oldest Known                    96.891886  \nCrash Hour                                                0.012189  \nDriver Contributing Circumstances (All Drivers)           2.714013  \nDriver Distracted By (All Vehicles)                      18.803072  \nFirst Harmful Event                                       0.012189  \nIs Geocoded                                               0.012189  \nLight Conditions                                          0.000000  \nManner of Collision                                       0.012189  \nVulnerable User Action (All Persons)                     97.188478  \nVulnerable User Location (All Persons)                   97.188478  \nVulnerable User Type (All Persons)                       96.956893  \nRMV Document Numbers                                      0.284403  \nRoad Surface Condition                                    0.000000  \nRoadway Junction Type                                     0.012189  \nRPA Abbreviation                                          0.012189  \nTraffic Control Device Type                               0.012189  \nTrafficway Description                                    0.012189  \nVehicle Actions Prior to Crash (All Vehicles)             0.012189  \nVehicle Configuration (All Vehicles)                      0.154390  \nVehicle Emergency Use (All Vehicles)                      2.685573  \nVehicle Towed From Scene (All Vehicles)                   0.316906  \nVehicle Travel Directions (All Vehicles)                  0.012189  \nWeather Conditions                                        0.000000  \nCounty Name                                               0.012189  \nCrash Report IDs                                          0.012189  \nFMCSA Reportable (All Vehicles)                           0.012189  \nFMCSA Reportable (Crash)                                  0.012189  \nFirst Harmful Event Location                              0.012189  \nGeocoding Method                                         18.047373  \nHit and Run                                               0.012189  \nLocality                                                 99.934994  \nMost Harmful Event (All Vehicles)                         1.222931  \nRoad Contributing Circumstance                           68.504449  \nSchool Bus Related                                        0.012189  \nTraffic Control Device Function                           0.012189  \nVehicle Sequence of Events (All Vehicles)                 0.954780  \nWork Zone Related                                         0.012189  \nVulnerable User Sequence of Events (All Persons)         99.922805  \nVulnerable User Distracted By (All Persons)              99.939057  \nVulnerable User Traffic Control Type (All persons)       99.930931  \nVulnerable User Origin Destination (All Persons)         99.930931  \nVulnerable User Contributing Circumstances (All...       99.939057  \nVulnerable User Alcohol Suspected Type (All Per...       99.943119  \nVulnerable User Drug Suspected Type (All Persons)        99.943119  \nVehicle Make                                              3.323447  \nVehicle Model                                            20.919839  \nSex                                                       6.321862  \nAge Group                                                 0.000000  \nWeather Group                                            93.288100   \n\n\n```\n:::\n:::\n\n\n::: {#c40a5e78 .cell execution_count=19}\n\n::: {.cell-output .cell-output-stdout}\n```\n  Crash Number City Town Name  Crash Date Crash Status Crash Time  Crash Year  \\\n0      5342297         LOWELL  01/01/2024         Open    3:26 AM      2024.0   \n1      5342292         LOWELL  01/01/2024         Open   12:48 AM      2024.0   \n2      5342292         LOWELL  01/01/2024         Open   12:48 AM      2024.0   \n3      5342292         LOWELL  01/01/2024         Open   12:48 AM      2024.0   \n4      5342292         LOWELL  01/01/2024         Open   12:48 AM      2024.0   \n\n  Max Injury Severity Reported  Number of Vehicles Police Agency Type  \\\n0          Possible Injury (C)                 1.0       Local police   \n1       No Apparent Injury (O)                 2.0       Local police   \n2       No Apparent Injury (O)                 2.0       Local police   \n3       No Apparent Injury (O)                 2.0       Local police   \n4       No Apparent Injury (O)                 2.0       Local police   \n\n  Age of Driver - Youngest Known  ...   Latitude  Longitude  \\\n0                          25-34  ...  42.339231 -71.207633   \n1                          55-64  ...  42.339231 -71.207633   \n2                          55-64  ...  42.339231 -71.207633   \n3                          55-64  ...  42.339231 -71.207633   \n4                          55-64  ...  42.339231 -71.207633   \n\n  Vehicle Unit Number Vehicle Make Vehicle Model Person Number   Age  \\\n0                 1.0         HOND          HR-V           1.0  32.0   \n1                 1.0         NISS        ALTIMA           1.0  60.0   \n2                 2.0         HOND        ACCORD           2.0  36.0   \n3                 2.0         HOND        ACCORD           3.0  31.0   \n4                 2.0         HOND        ACCORD           4.0  36.0   \n\n          Sex     Age Group feature_variable  \n0  F - Female         25-35                1  \n1    M - Male  60 and above                0  \n2    M - Male         35-50                0  \n3    M - Male         25-35                0  \n4    M - Male         35-50                0  \n\n[5 rows x 58 columns]\n```\n:::\n:::\n\n\n::: {#77995b94 .cell execution_count=20}\n\n::: {.cell-output .cell-output-stdout}\n```\n  Crash Number City Town Name  Crash Date Crash Status Crash Time  Crash Year  \\\n0      5342297         LOWELL  01/01/2024         Open    3:26 AM         0.0   \n1      5342292         LOWELL  01/01/2024         Open   12:48 AM         0.0   \n2      5342292         LOWELL  01/01/2024         Open   12:48 AM         0.0   \n3      5342292         LOWELL  01/01/2024         Open   12:48 AM         0.0   \n4      5342292         LOWELL  01/01/2024         Open   12:48 AM         0.0   \n\n  Max Injury Severity Reported  Number of Vehicles Police Agency Type  \\\n0          Possible Injury (C)           -1.388213       Local police   \n1       No Apparent Injury (O)            0.027963       Local police   \n2       No Apparent Injury (O)            0.027963       Local police   \n3       No Apparent Injury (O)            0.027963       Local police   \n4       No Apparent Injury (O)            0.027963       Local police   \n\n  Age of Driver - Youngest Known  ...  Latitude Longitude Vehicle Unit Number  \\\n0                          25-34  ...  0.325956  0.330683           -0.760059   \n1                          55-64  ...  0.325956  0.330683           -0.760059   \n2                          55-64  ...  0.325956  0.330683            0.806457   \n3                          55-64  ...  0.325956  0.330683            0.806457   \n4                          55-64  ...  0.325956  0.330683            0.806457   \n\n  Vehicle Make Vehicle Model Person Number       Age         Sex  \\\n0         HOND          HR-V     -0.587190 -0.376621  F - Female   \n1         NISS        ALTIMA     -0.587190  1.193908    M - Male   \n2         HOND        ACCORD      0.041754 -0.152259    M - Male   \n3         HOND        ACCORD      0.670698 -0.432711    M - Male   \n4         HOND        ACCORD      1.299642 -0.152259    M - Male   \n\n      Age Group feature_variable  \n0         25-35                1  \n1  60 and above                0  \n2         35-50                0  \n3         25-35                0  \n4         35-50                0  \n\n[5 rows x 58 columns]\n```\n:::\n:::\n\n\n::: {#06d1d06c .cell execution_count=21}\n\n::: {.cell-output .cell-output-stdout}\n```\n   Crash Year  Number of Vehicles  MassDOT District  Total Fatalities  \\\n0         0.0           -1.388213         -0.016167         -0.052805   \n1         0.0            0.027963         -0.016167         -0.052805   \n2         0.0            0.027963         -0.016167         -0.052805   \n3         0.0            0.027963         -0.016167         -0.052805   \n4         0.0            0.027963         -0.016167         -0.052805   \n\n   Total Non-Fatal Injuries  Speed Limit       X         Y  Latitude  \\\n0                  0.905249     0.056513  0.3275  0.321189  0.325956   \n1                 -0.447732    -0.343256  0.3275  0.321189  0.325956   \n2                 -0.447732    -0.343256  0.3275  0.321189  0.325956   \n3                 -0.447732    -0.343256  0.3275  0.321189  0.325956   \n4                 -0.447732    -0.343256  0.3275  0.321189  0.325956   \n\n   Longitude  ...  Vehicle Model_1228  Sex_0  Sex_1  Sex_2  Sex_3  \\\n0   0.330683  ...               False   True  False  False  False   \n1   0.330683  ...               False  False   True  False  False   \n2   0.330683  ...               False  False   True  False  False   \n3   0.330683  ...               False  False   True  False  False   \n4   0.330683  ...               False  False   True  False  False   \n\n   Age Group_0  Age Group_1  Age Group_2  Age Group_3  Age Group_4  \n0        False         True        False        False        False  \n1        False        False        False         True        False  \n2        False        False         True        False        False  \n3        False         True        False        False        False  \n4        False        False         True        False        False  \n\n[5 rows x 36680 columns]\n```\n:::\n:::\n\n\n\n\n::: {#06a017d7 .cell execution_count=23}\n\n::: {.cell-output .cell-output-stdout}\n```\nSelected features: \n\n Index(['Total Non-Fatal Injuries', 'Person Number', 'Crash Number_12',\n       'Crash Time_361', 'Max Injury Severity Reported_2',\n       'Max Injury Severity Reported_5', 'Max Injury Severity Reported_7',\n       'Crash Hour_0', 'Driver Contributing Circumstances (All Drivers)_125',\n       'Driver Contributing Circumstances (All Drivers)_471',\n       ...\n       'Crash Report IDs_3929', 'Crash Report IDs_3941',\n       'First Harmful Event Location_2', 'First Harmful Event Location_4',\n       'Most Harmful Event (All Vehicles)_132',\n       'Traffic Control Device Function_1',\n       'Traffic Control Device Function_3',\n       'Vehicle Sequence of Events (All Vehicles)_542', 'Vehicle Make_269',\n       'Age Group_0'],\n      dtype='object', length=7410)\n```\n:::\n:::\n\n\n::: {#af93fac4 .cell execution_count=24}\n\n::: {.cell-output .cell-output-stdout}\n```\nShape of X_train: (19690, 7410)\nShape of X_test: (4923, 7410)\nShape of y_train: (19690,)\nShape of y_test: (4923,)\n```\n:::\n:::\n\n\n::: {#49dcb327 .cell execution_count=25}\n\n::: {.cell-output .cell-output-display execution_count=25}\n```{=html}\n<style>#sk-container-id-1 {\n  /* Definition of color scheme common for light and dark mode */\n  --sklearn-color-text: black;\n  --sklearn-color-line: gray;\n  /* Definition of color scheme for unfitted estimators */\n  --sklearn-color-unfitted-level-0: #fff5e6;\n  --sklearn-color-unfitted-level-1: #f6e4d2;\n  --sklearn-color-unfitted-level-2: #ffe0b3;\n  --sklearn-color-unfitted-level-3: chocolate;\n  /* Definition of color scheme for fitted estimators */\n  --sklearn-color-fitted-level-0: #f0f8ff;\n  --sklearn-color-fitted-level-1: #d4ebff;\n  --sklearn-color-fitted-level-2: #b3dbfd;\n  --sklearn-color-fitted-level-3: cornflowerblue;\n\n  /* Specific color for light theme */\n  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));\n  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n  --sklearn-color-icon: #696969;\n\n  @media (prefers-color-scheme: dark) {\n    /* Redefinition of color scheme for dark theme */\n    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));\n    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n    --sklearn-color-icon: #878787;\n  }\n}\n\n#sk-container-id-1 {\n  color: var(--sklearn-color-text);\n}\n\n#sk-container-id-1 pre {\n  padding: 0;\n}\n\n#sk-container-id-1 input.sk-hidden--visually {\n  border: 0;\n  clip: rect(1px 1px 1px 1px);\n  clip: rect(1px, 1px, 1px, 1px);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n#sk-container-id-1 div.sk-dashed-wrapped {\n  border: 1px dashed var(--sklearn-color-line);\n  margin: 0 0.4em 0.5em 0.4em;\n  box-sizing: border-box;\n  padding-bottom: 0.4em;\n  background-color: var(--sklearn-color-background);\n}\n\n#sk-container-id-1 div.sk-container {\n  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`\n     but bootstrap.min.css set `[hidden] { display: none !important; }`\n     so we also need the `!important` here to be able to override the\n     default hidden behavior on the sphinx rendered scikit-learn.org.\n     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */\n  display: inline-block !important;\n  position: relative;\n}\n\n#sk-container-id-1 div.sk-text-repr-fallback {\n  display: none;\n}\n\ndiv.sk-parallel-item,\ndiv.sk-serial,\ndiv.sk-item {\n  /* draw centered vertical line to link estimators */\n  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));\n  background-size: 2px 100%;\n  background-repeat: no-repeat;\n  background-position: center center;\n}\n\n/* Parallel-specific style estimator block */\n\n#sk-container-id-1 div.sk-parallel-item::after {\n  content: \"\";\n  width: 100%;\n  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);\n  flex-grow: 1;\n}\n\n#sk-container-id-1 div.sk-parallel {\n  display: flex;\n  align-items: stretch;\n  justify-content: center;\n  background-color: var(--sklearn-color-background);\n  position: relative;\n}\n\n#sk-container-id-1 div.sk-parallel-item {\n  display: flex;\n  flex-direction: column;\n}\n\n#sk-container-id-1 div.sk-parallel-item:first-child::after {\n  align-self: flex-end;\n  width: 50%;\n}\n\n#sk-container-id-1 div.sk-parallel-item:last-child::after {\n  align-self: flex-start;\n  width: 50%;\n}\n\n#sk-container-id-1 div.sk-parallel-item:only-child::after {\n  width: 0;\n}\n\n/* Serial-specific style estimator block */\n\n#sk-container-id-1 div.sk-serial {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  background-color: var(--sklearn-color-background);\n  padding-right: 1em;\n  padding-left: 1em;\n}\n\n\n/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is\nclickable and can be expanded/collapsed.\n- Pipeline and ColumnTransformer use this feature and define the default style\n- Estimators will overwrite some part of the style using the `sk-estimator` class\n*/\n\n/* Pipeline and ColumnTransformer style (default) */\n\n#sk-container-id-1 div.sk-toggleable {\n  /* Default theme specific background. It is overwritten whether we have a\n  specific estimator or a Pipeline/ColumnTransformer */\n  background-color: var(--sklearn-color-background);\n}\n\n/* Toggleable label */\n#sk-container-id-1 label.sk-toggleable__label {\n  cursor: pointer;\n  display: block;\n  width: 100%;\n  margin-bottom: 0;\n  padding: 0.5em;\n  box-sizing: border-box;\n  text-align: center;\n}\n\n#sk-container-id-1 label.sk-toggleable__label-arrow:before {\n  /* Arrow on the left of the label */\n  content: \"▸\";\n  float: left;\n  margin-right: 0.25em;\n  color: var(--sklearn-color-icon);\n}\n\n#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {\n  color: var(--sklearn-color-text);\n}\n\n/* Toggleable content - dropdown */\n\n#sk-container-id-1 div.sk-toggleable__content {\n  max-height: 0;\n  max-width: 0;\n  overflow: hidden;\n  text-align: left;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-1 div.sk-toggleable__content.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-1 div.sk-toggleable__content pre {\n  margin: 0.2em;\n  border-radius: 0.25em;\n  color: var(--sklearn-color-text);\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-1 div.sk-toggleable__content.fitted pre {\n  /* unfitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {\n  /* Expand drop-down */\n  max-height: 200px;\n  max-width: 100%;\n  overflow: auto;\n}\n\n#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {\n  content: \"▾\";\n}\n\n/* Pipeline/ColumnTransformer-specific style */\n\n#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator-specific style */\n\n/* Colorize estimator box */\n#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n#sk-container-id-1 div.sk-label label.sk-toggleable__label,\n#sk-container-id-1 div.sk-label label {\n  /* The background is the default theme color */\n  color: var(--sklearn-color-text-on-default-background);\n}\n\n/* On hover, darken the color of the background */\n#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n/* Label box, darken color on hover, fitted */\n#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {\n  color: var(--sklearn-color-text);\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Estimator label */\n\n#sk-container-id-1 div.sk-label label {\n  font-family: monospace;\n  font-weight: bold;\n  display: inline-block;\n  line-height: 1.2em;\n}\n\n#sk-container-id-1 div.sk-label-container {\n  text-align: center;\n}\n\n/* Estimator-specific */\n#sk-container-id-1 div.sk-estimator {\n  font-family: monospace;\n  border: 1px dotted var(--sklearn-color-border-box);\n  border-radius: 0.25em;\n  box-sizing: border-box;\n  margin-bottom: 0.5em;\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-0);\n}\n\n#sk-container-id-1 div.sk-estimator.fitted {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-0);\n}\n\n/* on hover */\n#sk-container-id-1 div.sk-estimator:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-2);\n}\n\n#sk-container-id-1 div.sk-estimator.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-2);\n}\n\n/* Specification for estimator info (e.g. \"i\" and \"?\") */\n\n/* Common style for \"i\" and \"?\" */\n\n.sk-estimator-doc-link,\na:link.sk-estimator-doc-link,\na:visited.sk-estimator-doc-link {\n  float: right;\n  font-size: smaller;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1em;\n  height: 1em;\n  width: 1em;\n  text-decoration: none !important;\n  margin-left: 1ex;\n  /* unfitted */\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n  color: var(--sklearn-color-unfitted-level-1);\n}\n\n.sk-estimator-doc-link.fitted,\na:link.sk-estimator-doc-link.fitted,\na:visited.sk-estimator-doc-link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\ndiv.sk-estimator:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link:hover,\n.sk-estimator-doc-link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\ndiv.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover,\ndiv.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,\n.sk-estimator-doc-link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n/* Span, style for the box shown on hovering the info icon */\n.sk-estimator-doc-link span {\n  display: none;\n  z-index: 9999;\n  position: relative;\n  font-weight: normal;\n  right: .2ex;\n  padding: .5ex;\n  margin: .5ex;\n  width: min-content;\n  min-width: 20ex;\n  max-width: 50ex;\n  color: var(--sklearn-color-text);\n  box-shadow: 2pt 2pt 4pt #999;\n  /* unfitted */\n  background: var(--sklearn-color-unfitted-level-0);\n  border: .5pt solid var(--sklearn-color-unfitted-level-3);\n}\n\n.sk-estimator-doc-link.fitted span {\n  /* fitted */\n  background: var(--sklearn-color-fitted-level-0);\n  border: var(--sklearn-color-fitted-level-3);\n}\n\n.sk-estimator-doc-link:hover span {\n  display: block;\n}\n\n/* \"?\"-specific style due to the `<a>` HTML tag */\n\n#sk-container-id-1 a.estimator_doc_link {\n  float: right;\n  font-size: 1rem;\n  line-height: 1em;\n  font-family: monospace;\n  background-color: var(--sklearn-color-background);\n  border-radius: 1rem;\n  height: 1rem;\n  width: 1rem;\n  text-decoration: none;\n  /* unfitted */\n  color: var(--sklearn-color-unfitted-level-1);\n  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n}\n\n#sk-container-id-1 a.estimator_doc_link.fitted {\n  /* fitted */\n  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n  color: var(--sklearn-color-fitted-level-1);\n}\n\n/* On hover */\n#sk-container-id-1 a.estimator_doc_link:hover {\n  /* unfitted */\n  background-color: var(--sklearn-color-unfitted-level-3);\n  color: var(--sklearn-color-background);\n  text-decoration: none;\n}\n\n#sk-container-id-1 a.estimator_doc_link.fitted:hover {\n  /* fitted */\n  background-color: var(--sklearn-color-fitted-level-3);\n}\n</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>KNeighborsClassifier()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" checked><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow fitted\">&nbsp;&nbsp;KNeighborsClassifier<a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.4/modules/generated/sklearn.neighbors.KNeighborsClassifier.html\">?<span>Documentation for KNeighborsClassifier</span></a><span class=\"sk-estimator-doc-link fitted\">i<span>Fitted</span></span></label><div class=\"sk-toggleable__content fitted\"><pre>KNeighborsClassifier()</pre></div> </div></div></div></div>\n```\n:::\n:::\n\n\n::: {#e16b4413 .cell execution_count=26}\n\n::: {.cell-output .cell-output-stdout}\n```\nClassifier:  LogisticRegression(max_iter=1000, random_state=42, solver='liblinear')\nAccuracy:  1.0\nPrecision:  1.0\nRecall:  0.9990732159406858\nF1-Score:  0.9995363931386184\nClassifier:  DecisionTreeClassifier()\nAccuracy:  0.9999492127983748\nPrecision:  1.0\nRecall:  0.9990732159406858\nF1-Score:  0.9995363931386184\nClassifier:  RandomForestClassifier()\nAccuracy:  1.0\nPrecision:  1.0\nRecall:  0.9990732159406858\nF1-Score:  0.9995363931386184\nClassifier:  KNeighborsClassifier()\nAccuracy:  0.9997968511934993\nPrecision:  1.0\nRecall:  0.9981464318813716\nF1-Score:  0.9990723562152134\n```\n:::\n:::\n\n\n\n\n::: {#b993ac7f .cell execution_count=28}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-29-output-1.png){width=674 height=523}\n:::\n:::\n\n\n::: {#45529977 .cell execution_count=29}\n\n::: {.cell-output .cell-output-stdout}\n```\nLogistic Regression Accuracy: 1.0\nDecision Tree Accuracy: 1.0\nRandom Forest Accuracy: 1.0\nKNN Accuracy: 1.0\n```\n:::\n:::\n\n\n::: {#1857b410 .cell execution_count=30}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-31-output-1.png){width=564 height=449}\n:::\n:::\n\n\n::: {#7f789ed7 .cell execution_count=31}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-32-output-1.png){width=564 height=449}\n:::\n:::\n\n\n::: {#c8cc6d1f .cell execution_count=32}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-33-output-1.png){width=564 height=449}\n:::\n:::\n\n\n::: {#942a6b90 .cell execution_count=33}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-34-output-1.png){width=564 height=449}\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}